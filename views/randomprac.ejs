<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>رینڈم الفاظ کی مشق</title>
    <link rel="stylesheet" href="/styles/shared.css" />
    <link rel="stylesheet" href="/styles/navbtn.css">
  <style>
  :root {
  --primary-color: #008080;
  --secondary-color: #e9f5f5;
  --text-color: #3b3b3b;
  --hover-bg: #d0f0f0;
  --selected-bg: #b3e5fc;
  --correct-bg: #c8e6c9;
  --incorrect-bg: #ffcdd2;
  --button-bg: #008080;
  --button-hover: #006666;
}

body {
  font-family: 'Noto Nastaliq Urdu', serif;
  background-color: var(--secondary-color);
  color: var(--text-color);
  text-align: center;
  direction: rtl;
  padding: 20px;
  margin: 0;
}

h2 {
  color: var(--text-color);
  margin-bottom: 20px;
  font-size: 2rem;
}

.cards {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 12px;
  max-width: 1000px;
  margin: 0 auto 20px;
}

.card {
  background: white;
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  padding: 15px 20px;
  cursor: pointer;
  font-size: 1.4rem;
  min-width: 90px;
  user-select: none;
  transition: background-color 0.3s, border 0.3s, transform 0.2s;
  border: 2px solid transparent;
}

.card:hover {
  background-color: var(--hover-bg);
  transform: scale(1.03);
}

.card.selected {
  border-color: #0288d1;
  background-color: var(--selected-bg);
}

.card.correct {
  border-color: #4caf50;
  background-color: var(--correct-bg);
}

.card.incorrect {
  border-color: #f44336;
  background-color: var(--incorrect-bg);
}

#startBtn {
  margin-top: 25px;
  font-size: 1.2rem;
  padding: 10px 25px;
  background-color: var(--button-bg);
  border: none;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  display: none; /* shown only when a card is selected */
  user-select: none;
  transition: background-color 0.3s ease;
}

#startBtn:hover {
  background-color: var(--button-hover);
}

#result {
  margin-top: 30px;
  font-size: 1.2rem;
  min-height: 3rem;
  color: var(--text-color);
  white-space: pre-line;
}

/* ✅ Responsive Layout */
@media (max-width: 768px) {
  .card {
    font-size: 1.2rem;
    padding: 12px 16px;
    min-width: 80px;
  }

  #startBtn {
    font-size: 1rem;
    padding: 10px 20px;
  }

  h2 {
    font-size: 1.8rem;
  }
}

@media (max-width: 480px) {
  .cards {
    gap: 10px;
  }

  .card {
    font-size: 1.1rem;
    min-width: 70px;
    padding: 10px 12px;
  }

  #startBtn {
    width: 100%;
    font-size: 1rem;
  }

  #result {
    font-size: 1rem;
  }
}

  </style>
</head>
<body>
 <%- include('partials/header') %>
 <%- include('partials/navbtn') %>

  <h2>رینڈم الفاظ کی مشق (Random Words Practice)</h2>

  <div class="cards" id="wordCards">
    <div class="card" data-audio="assets/audio/random/Male/main.wav" data-word="میں">میں</div>
    <div class="card" data-audio="audio/random/Male/hum.wav" data-word="ہم">ہم</div>
    <div class="card" data-audio="audio/random/Male/tum.wav" data-word="تم">تم</div>
    <div class="card" data-audio="audio/random/Male/aap.wav" data-word="آپ">آپ</div>
    <div class="card" data-audio="audio/random/Male/aur.wav" data-word="اور">اور</div>
    <div class="card" data-audio="audio/random/Male/bhi.wav" data-word="بھی">بھی</div>
    <div class="card" data-audio="audio/random/Male/yh.wav" data-word="یہ">یہ</div>
    <div class="card" data-audio="audio/random/Male/nhi.wav" data-word="نہیں">نہیں</div>
    <div class="card" data-audio="audio/random/Male/han.wav" data-word="ہاں">ہاں</div>
    <div class="card" data-audio="audio/random/Male/kya.wav" data-word="کیا">کیا</div>
    <div class="card" data-audio="audio/random/Male/hasil.wav" data-word="حاصل">حاصل</div>
    <div class="card" data-audio="audio/random/Male/sab.wav" data-word="سب">سب</div>
    <div class="card" data-audio="audio/random/Male/karna.wav" data-word="کرنا">کرنا</div>
    <div class="card" data-audio="audio/random/Male/jana.wav" data-word="جانا">جانا</div>
    <div class="card" data-audio="audio/random/Male/har.wav" data-word="ہر">ہر</div>
    <div class="card" data-audio="audio/random/Male/khan.wav" data-word="خان">خان</div>
    <div class="card" data-audio="audio/random/Male/pehly.wav" data-word="پہلے">پہلے</div>
    <div class="card" data-audio="audio/random/Male/kuch.wav" data-word="کچھ">کچھ</div>
    <div class="card" data-audio="audio/random/Male/sirf.wav" data-word="صرف">صرف</div>
    <div class="card" data-audio="audio/random/Male/saal.wav" data-word="سال">سال</div>
    <div class="card" data-audio="audio/random/Male/maheena.wav" data-word="مہینہ">مہینہ</div>
    <div class="card" data-audio="audio/random/Male/wja.wav" data-word="وجہ">وجہ</div>
    <div class="card" data-audio="audio/random/Male/km.wav" data-word="کم">کم</div>
    <div class="card" data-audio="audio/random/Male/zaaid.wav" data-word="ذائد">ذائد</div>
    <div class="card" data-audio="audio/random/Male/jang.wav" data-word="جنگ">جنگ</div>
    <div class="card" data-audio="audio/random/Male/team.wav" data-word="ٹیم">ٹیم</div>
    <div class="card" data-audio="audio/random/Male/sadar.wav" data-word="صدر">صدر</div>
    <div class="card" data-audio="audio/random/Male/mutabiq.wav" data-word="مطابق">مطابق</div>
    <div class="card" data-audio="audio/random/Male/tmam.wav" data-word="تمام">تمام</div>
    <div class="card" data-audio="audio/random/Male/khilaf.wav" data-word="خلاف">خلاف</div>
    <div class="card" data-audio="audio/random/Male/sath.wav" data-word="ساتھ">ساتھ</div>
    <div class="card" data-audio="audio/random/Male/wali.wav" data-word="والی">والی</div>
    <div class="card" data-audio="audio/random/Male/taraf.wav" data-word="طرف">طرف</div>
    <div class="card" data-audio="audio/random/Male/phr.wav" data-word="پھر">پھر</div>
    <div class="card" data-audio="audio/random/Male/duniya.wav" data-word="دنیا">دنیا</div>
    <div class="card" data-audio="audio/random/Male/log.wav" data-word="لوگ">لوگ</div>
    <div class="card" data-audio="audio/random/Male/shuruh.wav" data-word="شروع">شروع</div>
    <div class="card" data-audio="audio/random/Male/afrad.wav" data-word="افراد">افراد</div>
    <div class="card" data-audio="audio/random/Male/wazeer.wav" data-word="وزیر">وزیر</div>
    <div class="card" data-audio="audio/random/Male/awam.wav" data-word="عوام">عوام</div>
    <div class="card" data-audio="audio/random/Male/amal.wav" data-word="عمل">عمل</div>
  </div>

  <button id="startBtn">مشق شروع کریں (Start Practice)</button>

  <div id="result"></div>

<script>
  const cards = document.querySelectorAll('.card');
  const startBtn = document.getElementById('startBtn');
  const resultDiv = document.getElementById('result');

  let selectedCard = null;

  function resetSelection() {
    cards.forEach(c => {
      c.classList.remove('selected', 'correct', 'incorrect');
    });
    resultDiv.textContent = '';
    startBtn.style.display = 'none';
    selectedCard = null;
  }

  cards.forEach(card => {
    card.addEventListener('click', () => {
      resetSelection();

      selectedCard = card;
      card.classList.add('selected');

      // Play audio automatically on card click
      const audio = new Audio(card.dataset.audio);
      audio.play();

      // Show start button
      startBtn.style.display = 'inline-block';

      resultDiv.textContent = '🎧 پہلے آڈیو سنیں پھر "مشق شروع کریں" پر کلک کریں اور بولنا شروع کریں۔';
    });
  });

  startBtn.addEventListener('click', () => {
    if (!selectedCard) return;

    resultDiv.textContent = '🎙️ بولنا شروع کریں...';

    // Speech Recognition setup
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (!SpeechRecognition) {
      resultDiv.textContent = 'یہ فیچر آپ کے براؤزر میں دستیاب نہیں ہے۔';
      return;
    }

    const recognition = new SpeechRecognition();
    recognition.lang = 'ur-PK';
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;

    recognition.start();

    recognition.onresult = (event) => {
      const spokenText = event.results[0][0].transcript.trim();
      const targetWord = selectedCard.dataset.word.trim();

      // Compare the recognized text with target word ignoring diacritics and spaces:
      const normalizeText = (txt) => txt.replace(/[\u064B-\u0652\s]/g, '').toLowerCase();
      const normalizedSpoken = normalizeText(spokenText);
      const normalizedTarget = normalizeText(targetWord);

      if (normalizedSpoken === normalizedTarget) {
        resultDiv.textContent = `✅ درست! آپ نے "${spokenText}" صحیح کہا۔`;
        selectedCard.classList.add('correct');
        selectedCard.classList.remove('incorrect');
      } else {
        resultDiv.textContent = `❌ غلط! آپ نے کہا: "${spokenText}" \nصحیح لفظ ہے: "${targetWord}"۔ دوبارہ کوشش کریں۔`;
        selectedCard.classList.add('incorrect');
        selectedCard.classList.remove('correct');
      }
    };

    recognition.onerror = (event) => {
      resultDiv.textContent = 'مسئلہ پیدا ہوا: ' + event.error;
    };

    recognition.onend = () => {
      // You may optionally restart recognition here for continuous practice,
      // or leave it ended for user to click Start again.
    };
  });
</script>
 <%- include('partials/footer') %>

</body>
</html>
