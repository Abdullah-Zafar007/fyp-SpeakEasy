<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ø±ÛŒÙ†ÚˆÙ… Ø§Ù„ÙØ§Ø¸ Ú©ÛŒ Ù…Ø´Ù‚</title>
    <link rel="stylesheet" href="/styles/shared.css" />
    <link rel="stylesheet" href="/styles/navbtn.css">
  <style>
  :root {
  --primary-color: #008080;
  --secondary-color: #e9f5f5;
  --text-color: #3b3b3b;
  --hover-bg: #d0f0f0;
  --selected-bg: #b3e5fc;
  --correct-bg: #c8e6c9;
  --incorrect-bg: #ffcdd2;
  --button-bg: #008080;
  --button-hover: #006666;
}

body {
  font-family: 'Noto Nastaliq Urdu', serif;
  background-color: var(--secondary-color);
  color: var(--text-color);
  text-align: center;
  direction: rtl;
  padding: 20px;
  margin: 0;
}

h2 {
  color: var(--text-color);
  margin-bottom: 20px;
  font-size: 2rem;
}

.cards {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 12px;
  max-width: 1000px;
  margin: 0 auto 20px;
}

.card {
  background: white;
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  padding: 15px 20px;
  cursor: pointer;
  font-size: 1.4rem;
  min-width: 90px;
  user-select: none;
  transition: background-color 0.3s, border 0.3s, transform 0.2s;
  border: 2px solid transparent;
}

.card:hover {
  background-color: var(--hover-bg);
  transform: scale(1.03);
}

.card.selected {
  border-color: #0288d1;
  background-color: var(--selected-bg);
}

.card.correct {
  border-color: #4caf50;
  background-color: var(--correct-bg);
}

.card.incorrect {
  border-color: #f44336;
  background-color: var(--incorrect-bg);
}

#startBtn {
  margin-top: 25px;
  font-size: 1.2rem;
  padding: 10px 25px;
  background-color: var(--button-bg);
  border: none;
  border-radius: 8px;
  color: white;
  cursor: pointer;
  display: none; /* shown only when a card is selected */
  user-select: none;
  transition: background-color 0.3s ease;
}

#startBtn:hover {
  background-color: var(--button-hover);
}

#result {
  margin-top: 30px;
  font-size: 1.2rem;
  min-height: 3rem;
  color: var(--text-color);
  white-space: pre-line;
}

/* âœ… Responsive Layout */
@media (max-width: 768px) {
  .card {
    font-size: 1.2rem;
    padding: 12px 16px;
    min-width: 80px;
  }

  #startBtn {
    font-size: 1rem;
    padding: 10px 20px;
  }

  h2 {
    font-size: 1.8rem;
  }
}

@media (max-width: 480px) {
  .cards {
    gap: 10px;
  }

  .card {
    font-size: 1.1rem;
    min-width: 70px;
    padding: 10px 12px;
  }

  #startBtn {
    width: 100%;
    font-size: 1rem;
  }

  #result {
    font-size: 1rem;
  }
}

  </style>
</head>
<body>
 <%- include('partials/header') %>
 <%- include('partials/navbtn') %>

  <h2>Ø±ÛŒÙ†ÚˆÙ… Ø§Ù„ÙØ§Ø¸ Ú©ÛŒ Ù…Ø´Ù‚ (Random Words Practice)</h2>

  <div class="cards" id="wordCards">
    <div class="card" data-audio="assets/audio/random/Male/main.wav" data-word="Ù…ÛŒÚº">Ù…ÛŒÚº</div>
    <div class="card" data-audio="audio/random/Male/hum.wav" data-word="ÛÙ…">ÛÙ…</div>
    <div class="card" data-audio="audio/random/Male/tum.wav" data-word="ØªÙ…">ØªÙ…</div>
    <div class="card" data-audio="audio/random/Male/aap.wav" data-word="Ø¢Ù¾">Ø¢Ù¾</div>
    <div class="card" data-audio="audio/random/Male/aur.wav" data-word="Ø§ÙˆØ±">Ø§ÙˆØ±</div>
    <div class="card" data-audio="audio/random/Male/bhi.wav" data-word="Ø¨Ú¾ÛŒ">Ø¨Ú¾ÛŒ</div>
    <div class="card" data-audio="audio/random/Male/yh.wav" data-word="ÛŒÛ">ÛŒÛ</div>
    <div class="card" data-audio="audio/random/Male/nhi.wav" data-word="Ù†ÛÛŒÚº">Ù†ÛÛŒÚº</div>
    <div class="card" data-audio="audio/random/Male/han.wav" data-word="ÛØ§Úº">ÛØ§Úº</div>
    <div class="card" data-audio="audio/random/Male/kya.wav" data-word="Ú©ÛŒØ§">Ú©ÛŒØ§</div>
    <div class="card" data-audio="audio/random/Male/hasil.wav" data-word="Ø­Ø§ØµÙ„">Ø­Ø§ØµÙ„</div>
    <div class="card" data-audio="audio/random/Male/sab.wav" data-word="Ø³Ø¨">Ø³Ø¨</div>
    <div class="card" data-audio="audio/random/Male/karna.wav" data-word="Ú©Ø±Ù†Ø§">Ú©Ø±Ù†Ø§</div>
    <div class="card" data-audio="audio/random/Male/jana.wav" data-word="Ø¬Ø§Ù†Ø§">Ø¬Ø§Ù†Ø§</div>
    <div class="card" data-audio="audio/random/Male/har.wav" data-word="ÛØ±">ÛØ±</div>
    <div class="card" data-audio="audio/random/Male/khan.wav" data-word="Ø®Ø§Ù†">Ø®Ø§Ù†</div>
    <div class="card" data-audio="audio/random/Male/pehly.wav" data-word="Ù¾ÛÙ„Û’">Ù¾ÛÙ„Û’</div>
    <div class="card" data-audio="audio/random/Male/kuch.wav" data-word="Ú©Ú†Ú¾">Ú©Ú†Ú¾</div>
    <div class="card" data-audio="audio/random/Male/sirf.wav" data-word="ØµØ±Ù">ØµØ±Ù</div>
    <div class="card" data-audio="audio/random/Male/saal.wav" data-word="Ø³Ø§Ù„">Ø³Ø§Ù„</div>
    <div class="card" data-audio="audio/random/Male/maheena.wav" data-word="Ù…ÛÛŒÙ†Û">Ù…ÛÛŒÙ†Û</div>
    <div class="card" data-audio="audio/random/Male/wja.wav" data-word="ÙˆØ¬Û">ÙˆØ¬Û</div>
    <div class="card" data-audio="audio/random/Male/km.wav" data-word="Ú©Ù…">Ú©Ù…</div>
    <div class="card" data-audio="audio/random/Male/zaaid.wav" data-word="Ø°Ø§Ø¦Ø¯">Ø°Ø§Ø¦Ø¯</div>
    <div class="card" data-audio="audio/random/Male/jang.wav" data-word="Ø¬Ù†Ú¯">Ø¬Ù†Ú¯</div>
    <div class="card" data-audio="audio/random/Male/team.wav" data-word="Ù¹ÛŒÙ…">Ù¹ÛŒÙ…</div>
    <div class="card" data-audio="audio/random/Male/sadar.wav" data-word="ØµØ¯Ø±">ØµØ¯Ø±</div>
    <div class="card" data-audio="audio/random/Male/mutabiq.wav" data-word="Ù…Ø·Ø§Ø¨Ù‚">Ù…Ø·Ø§Ø¨Ù‚</div>
    <div class="card" data-audio="audio/random/Male/tmam.wav" data-word="ØªÙ…Ø§Ù…">ØªÙ…Ø§Ù…</div>
    <div class="card" data-audio="audio/random/Male/khilaf.wav" data-word="Ø®Ù„Ø§Ù">Ø®Ù„Ø§Ù</div>
    <div class="card" data-audio="audio/random/Male/sath.wav" data-word="Ø³Ø§ØªÚ¾">Ø³Ø§ØªÚ¾</div>
    <div class="card" data-audio="audio/random/Male/wali.wav" data-word="ÙˆØ§Ù„ÛŒ">ÙˆØ§Ù„ÛŒ</div>
    <div class="card" data-audio="audio/random/Male/taraf.wav" data-word="Ø·Ø±Ù">Ø·Ø±Ù</div>
    <div class="card" data-audio="audio/random/Male/phr.wav" data-word="Ù¾Ú¾Ø±">Ù¾Ú¾Ø±</div>
    <div class="card" data-audio="audio/random/Male/duniya.wav" data-word="Ø¯Ù†ÛŒØ§">Ø¯Ù†ÛŒØ§</div>
    <div class="card" data-audio="audio/random/Male/log.wav" data-word="Ù„ÙˆÚ¯">Ù„ÙˆÚ¯</div>
    <div class="card" data-audio="audio/random/Male/shuruh.wav" data-word="Ø´Ø±ÙˆØ¹">Ø´Ø±ÙˆØ¹</div>
    <div class="card" data-audio="audio/random/Male/afrad.wav" data-word="Ø§ÙØ±Ø§Ø¯">Ø§ÙØ±Ø§Ø¯</div>
    <div class="card" data-audio="audio/random/Male/wazeer.wav" data-word="ÙˆØ²ÛŒØ±">ÙˆØ²ÛŒØ±</div>
    <div class="card" data-audio="audio/random/Male/awam.wav" data-word="Ø¹ÙˆØ§Ù…">Ø¹ÙˆØ§Ù…</div>
    <div class="card" data-audio="audio/random/Male/amal.wav" data-word="Ø¹Ù…Ù„">Ø¹Ù…Ù„</div>
  </div>

  <button id="startBtn">Ù…Ø´Ù‚ Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº (Start Practice)</button>

  <div id="result"></div>

<script>
  const cards = document.querySelectorAll('.card');
  const startBtn = document.getElementById('startBtn');
  const resultDiv = document.getElementById('result');

  let selectedCard = null;

  function resetSelection() {
    cards.forEach(c => {
      c.classList.remove('selected', 'correct', 'incorrect');
    });
    resultDiv.textContent = '';
    startBtn.style.display = 'none';
    selectedCard = null;
  }

  cards.forEach(card => {
    card.addEventListener('click', () => {
      resetSelection();

      selectedCard = card;
      card.classList.add('selected');

      // Play audio automatically on card click
      const audio = new Audio(card.dataset.audio);
      audio.play();

      // Show start button
      startBtn.style.display = 'inline-block';

      resultDiv.textContent = 'ğŸ§ Ù¾ÛÙ„Û’ Ø¢ÚˆÛŒÙˆ Ø³Ù†ÛŒÚº Ù¾Ú¾Ø± "Ù…Ø´Ù‚ Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº" Ù¾Ø± Ú©Ù„Ú© Ú©Ø±ÛŒÚº Ø§ÙˆØ± Ø¨ÙˆÙ„Ù†Ø§ Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚºÛ”';
    });
  });

  startBtn.addEventListener('click', () => {
    if (!selectedCard) return;

    resultDiv.textContent = 'ğŸ™ï¸ Ø¨ÙˆÙ„Ù†Ø§ Ø´Ø±ÙˆØ¹ Ú©Ø±ÛŒÚº...';

    // Speech Recognition setup
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (!SpeechRecognition) {
      resultDiv.textContent = 'ÛŒÛ ÙÛŒÚ†Ø± Ø¢Ù¾ Ú©Û’ Ø¨Ø±Ø§Ø¤Ø²Ø± Ù…ÛŒÚº Ø¯Ø³ØªÛŒØ§Ø¨ Ù†ÛÛŒÚº ÛÛ’Û”';
      return;
    }

    const recognition = new SpeechRecognition();
    recognition.lang = 'ur-PK';
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;

    recognition.start();

    recognition.onresult = (event) => {
      const spokenText = event.results[0][0].transcript.trim();
      const targetWord = selectedCard.dataset.word.trim();

      // Compare the recognized text with target word ignoring diacritics and spaces:
      const normalizeText = (txt) => txt.replace(/[\u064B-\u0652\s]/g, '').toLowerCase();
      const normalizedSpoken = normalizeText(spokenText);
      const normalizedTarget = normalizeText(targetWord);

      if (normalizedSpoken === normalizedTarget) {
        resultDiv.textContent = `âœ… Ø¯Ø±Ø³Øª! Ø¢Ù¾ Ù†Û’ "${spokenText}" ØµØ­ÛŒØ­ Ú©ÛØ§Û”`;
        selectedCard.classList.add('correct');
        selectedCard.classList.remove('incorrect');
      } else {
        resultDiv.textContent = `âŒ ØºÙ„Ø·! Ø¢Ù¾ Ù†Û’ Ú©ÛØ§: "${spokenText}" \nØµØ­ÛŒØ­ Ù„ÙØ¸ ÛÛ’: "${targetWord}"Û” Ø¯ÙˆØ¨Ø§Ø±Û Ú©ÙˆØ´Ø´ Ú©Ø±ÛŒÚºÛ”`;
        selectedCard.classList.add('incorrect');
        selectedCard.classList.remove('correct');
      }
    };

    recognition.onerror = (event) => {
      resultDiv.textContent = 'Ù…Ø³Ø¦Ù„Û Ù¾ÛŒØ¯Ø§ ÛÙˆØ§: ' + event.error;
    };

    recognition.onend = () => {
      // You may optionally restart recognition here for continuous practice,
      // or leave it ended for user to click Start again.
    };
  });
</script>
 <%- include('partials/footer') %>

</body>
</html>
